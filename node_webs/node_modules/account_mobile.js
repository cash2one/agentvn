//-------------------------------------------------------------------------------------------------------
// account_mobile.js
//-------------------------------------------------------------------------------------------------------
exports.check_mobile = function(account, mobile, cb){
    var db      = ms.db.mssql['ShangYoo_Mobile']
    var sp_name = 'cp_UsrePhone_GetRecordInfo'

    if (!db) {        
        console.error('db not connected')
        cb(1)
    }


    var args = [ account ]
    db.exec_sp(sp_name, args, function(err, rows, output, ret) {
        if (err) {
            console.error(err)
            cb(1)
            return
        }
        
        if(rows.length==0){     
            console.error('mobile is not exist')
            cb(2) 
            return
        }

        if(rows[0].Phone!=mobile){
            console.error('mobile is error')
            cb(3)
            return
        }
        
        cb(0)
    })
}
//-------------------------------------------------------------------------------------------------------
exports.check_appid = function(account, appid, cb) {   
    var db      = ms.db.mssql['ShangYoo_Mobile']
    var sp_name = 'cp_UserApp_GetRecordInfo'

    if (!db) {        
        console.error('db not connected')
        cb(1)
        return
    }


    var args = [ account, appid ]
    db.exec_sp(sp_name, args, function(err, rows, output, ret) {
        if (err) {
            console.error(err)
            cb(1)
            return
        }
        
        if(ret==-1){     
            console.error('account is not exist')
            cb(2) 
            return
        }

        if(ret==-2){     
            console.error('appid is error')
            cb(3) 
            return
        }

        cb(0)
    })
}
//-------------------------------------------------------------------------------------------------------