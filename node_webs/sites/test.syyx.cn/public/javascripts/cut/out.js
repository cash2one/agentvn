var IMG_CUT={width:160,height:120,upload_url:"/img_upload"};
(function(){1;$("#img_cut_case").css({width:IMG_CUT.width,height:IMG_CUT.height,left:150-IMG_CUT.width/2-1,top:150-IMG_CUT.height/2-1});var c,d,f=!1;$("#img_cut_img").load(function(){c=this.offsetWidth;d=this.offsetHeight;300>c&&300>d&&(zoom=1);c>d&&($(this).css("width","100%"),zoom=300/c);c<d&&($(this).css("height","100%"),zoom=300/d);$(this).css({"margin-top":-d*zoom/2,"margin-left":-c*zoom/2,opacity:"1",filter:"alpha(opacity=100)"});$("#img_cut_view").css("display","block");$("#img_cut_action").css("display",
"block");$("#img_cut_zoom").css("display","block")});$("#img_cut_zoom_big").click(function(a){a.preventDefault();if(!(1==zoom||!0==f)){a=zoom+0.1;1<=a&&(a=1);var b=$("#img_cut_img").css("margin-left").replace("px",""),d=$("#img_cut_img").css("margin-top").replace("px","");f=!0;$("#img_cut_img").stop().animate({width:a*c,"margin-top":d*(0.1/zoom+1),"margin-left":b*(0.1/zoom+1)},function(){f=!1});zoom=a}});$("#img_cut_zoom_small").click(function(a){a.preventDefault();if(!(300>=Math.max(c*zoom,d*zoom)||
!0==f)){a=zoom-0.1;300>=Math.max(a*c,a*d)&&(a=300/c);var b=$("#img_cut_img").css("margin-left").replace("px","")-0,i=$("#img_cut_img").css("margin-top").replace("px","")-0;f=!0;$("#img_cut_img").animate({width:a*c,"margin-top":i*(1-0.1/zoom),"margin-left":b*(1-0.1/zoom)},function(){f=!1});zoom=a}});(function(a,b){var f=[],h=[],e={"margin-left":0,"margin-top":0};$(b).mousedown(function(g){f=[g.pageX,g.pageY];h=[$(a).css("margin-left").replace("px","")-0,$(a).css("margin-top").replace("px","")-0];g.stopPropagation();
g.preventDefault();$(b).mousemove(function(b){b.preventDefault();b.stopPropagation();b=[b.pageX,b.pageY];e["margin-left"]=h[0]+b[0]-f[0];e["margin-top"]=h[1]+b[1]-f[1];var b=150+c*zoom,g=150+d*zoom;e["margin-left"]<-b&&(e["margin-left"]=-b);150<e["margin-left"]&&(e["margin-left"]=150);e["margin-top"]<-g&&(e["margin-top"]=-g);150<e["margin-top"]&&(e["margin-top"]=150);$(a).css(e)});$(b).one("mouseup",function(){$(b).unbind("mousemove")});$(b).one("mouseout",function(){$(b).unbind("mousemove")})})})("#img_cut_img",
"#img_cut_drug");$("#img_cut_upload_sub").click(function(){var a=document.createElement("iframe");a.id="post_iframe";document.body.appendChild(a);a.style.display="none";a.contentWindow.name="iframe_post";$(a).bind({load:function(){var a=window.frames.iframe_post.document.body.innerHTML;"err"!==a?($("#img_cut_upload span").append($("#img_cut_file")),$("#post_iframe").remove(),$("#post_form").remove(),$("#img_cut_img").attr("src",a).css("display","inline"),$("#img_cut_view span").fadeOut()):alert("\u670d\u52a1\u5668\u9519\u8bef")}});
a=document.createElement("form");a.id="post_form";a.action=IMG_CUT.upload_url;a.method="POST";a.enctype="multipart/form-data";a.target="iframe_post";a.style.display="none";$(a).append($("#img_cut_file"));$(document.body).append(a);$("#post_form").submit();$("#img_cut_view").css("display","block");$("#img_cut_upload").css("display","none")});$("#img_cut_zoom_num").click(function(){var a=-IMG_CUT.width/2-$("#img_cut_img").css("margin-left").replace("px",""),b=-IMG_CUT.height/2-$("#img_cut_img").css("margin-top").replace("px",
"");alert("\u5bbd\u5ea6\uff1a"+IMG_CUT.width+"\t\u9ad8\u5ea6\uff1a"+IMG_CUT.height+"\t\u7f29\u653e\uff1a"+100*zoom+"\tx\uff1a"+a+"\ty:"+b)});$("#img_cut_zoom_rep").click(function(){$("#img_cut_box *").not("#img_cut_case").removeAttr("style");$("#img_cut_img").removeAttr("src")})})();
