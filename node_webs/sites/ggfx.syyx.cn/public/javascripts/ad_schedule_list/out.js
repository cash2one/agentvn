function formatEnabled(a){return a?"<font color='blue'>\u542f\u7528</font>":"<font color='red'>\u7981\u7528</font>"}function formatSchedule(a){return a?"<font color='blue'>\u5df2\u8bbe\u7f6e</font>":"<font color='red'>\u8bbe\u7f6e\u4e2d</font>"}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}
function getAdUrl(a,b,h,g,i){return 1==i?"<a href='/ad_report_phase.html?ClassID="+a+"&MediaID="+b+"&ADID="+h+"&Date="+g+"'>\u221a</a>":" "}function checkAllByID(a){for(var b=document.getElementsByTagName("input"),h=b.length,g=0;g<h;g++)"checkbox"==b[g].type&&b[g].name==name&&(b[g].checked=a.checked)}function checkAllByName(a,b){var h=document.getElementsByName(b);if(void 0!=h)for(var g=0;g<h.length;g++)h[g].checked=a.checked}
Date.prototype.isLeapYear=function(){return 0==this.getYear()%4&&(0!=this.getYear()%100||0==this.getYear()%400)};
Date.prototype.Format=function(a){a=a.replace(/yyyy|YYYY/,this.getFullYear());a=a.replace(/yy|YY/,9<this.getYear()%100?(this.getYear()%100).toString():"0"+this.getYear()%100);a=a.replace(/MM/,9<this.getMonth()+1?(this.getMonth()+1).toString():"0"+(this.getMonth()+1));a=a.replace(/M/g,this.getMonth());a=a.replace(/w|W/g,"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",")[this.getDay()]);a=a.replace(/dd|DD/,9<this.getDate()?this.getDate().toString():"0"+this.getDate());a=a.replace(/d|D/g,
this.getDate());a=a.replace(/hh|HH/,9<this.getHours()?this.getHours().toString():"0"+this.getHours());a=a.replace(/h|H/g,this.getHours());a=a.replace(/mm/,9<this.getMinutes()?this.getMinutes().toString():"0"+this.getMinutes());a=a.replace(/m/g,this.getMinutes());a=a.replace(/ss|SS/,9<this.getSeconds()?this.getSeconds().toString():"0"+this.getSeconds());return a=a.replace(/s|S/g,this.getSeconds())};
Date.prototype.DateAdd=function(a,b){switch(a){case "s":return new Date(Date.parse(this)+1E3*b);case "n":return new Date(Date.parse(this)+6E4*b);case "h":return new Date(Date.parse(this)+36E5*b);case "d":return new Date(Date.parse(this)+864E5*b);case "w":return new Date(Date.parse(this)+6048E5*b);case "q":return new Date(this.getFullYear(),this.getMonth()+3*b,this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds());case "m":return new Date(this.getFullYear(),this.getMonth()+b,this.getDate(),
this.getHours(),this.getMinutes(),this.getSeconds());case "y":return new Date(this.getFullYear()+b,this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())}};
Date.prototype.DateDiff=function(a,b){"string"==typeof b&&(b=StringToDate(b));switch(a){case "s":return parseInt((b-this)/1E3);case "n":return parseInt((b-this)/6E4);case "h":return parseInt((b-this)/36E5);case "d":return parseInt((b-this)/864E5);case "w":return parseInt((b-this)/6048E5);case "m":return b.getMonth()+1+12*(b.getFullYear()-this.getFullYear())-(this.getMonth()+1);case "y":return b.getFullYear()-this.getFullYear()}};
Date.prototype.DatePart=function(a){var b="",h="\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",");switch(a){case "y":b=this.getFullYear();break;case "m":b=this.getMonth()+1;break;case "d":b=this.getDate();break;case "w":b=h[this.getDay()];break;case "ww":b=this.WeekNumOfYear();break;case "h":b=this.getHours();break;case "n":b=this.getMinutes();break;case "s":b=this.getSeconds()}return b};Date.prototype.FirstDayOfDate=function(){var a=this.toArray();return new Date(a[0],a[1],1)};
Date.prototype.LastDayOfDate=function(){return this.FirstDayOfDate().DateAdd("m",1).DateAdd("d",-1)};Date.prototype.MaxDayOfDate=function(){return this.LastDayOfDate().DatePart("d")};Date.prototype.toArray=function(){var a=[];a[0]=this.getFullYear();a[1]=this.getMonth();a[2]=this.getDate();a[3]=this.getHours();a[4]=this.getMinutes();a[5]=this.getSeconds();return a};
function IsValidDate(a){var b=a.replace(/(^\s+|\s+$)/g,"");if(""==b)return!0;if(""==b.replace(/[\d]{ 4,4 }[\-/]{ 1 }[\d]{ 1,2 }[\-/]{ 1 }[\d]{ 1,2 }/g,"")){if(a=new Date(b.replace(/\-/g,"/")),b=b.split(/[-/:]/),b[0]!=a.getYear()||b[1]!=a.getMonth()+1||b[2]!=a.getDate())return!1}else return!1;return!0}
function CheckDateTime(a){a=a.match(/^(\d+)-(\d{ 1,2 })-(\d{ 1,2 }) (\d{ 1,2 }):(\d{ 1,2 }):(\d{ 1,2 })$/);if(null==a)return!1;a[2]-=1;var b=new Date(a[1],a[2],a[3],a[4],a[5],a[6]);return b.getFullYear()!=a[1]||b.getMonth()!=a[2]||b.getDate()!=a[3]||b.getHours()!=a[4]||b.getMinutes()!=a[5]||b.getSeconds()!=a[6]?!1:!0}function StringToDate(a){var b=Date.parse(a),b=new Date(b);isNaN(b)&&(a=a.split("-"),b=new Date(a[0],--a[1],a[2]));return b};$(function(){var a=new Date;$("#txtDateTime").datebox("setValue",a.Format("yyyy-MM"));$("#btnPreMonth").click(function(){set_date(-1)});$("#btnNextMonth").click(function(){set_date(1)});create_cols()});function set_date(a){a=StringToDate($("#txtDateTime").datebox("getValue")+"-01").DateAdd("m",a).Format("yyyy-MM");$("#txtDateTime").datebox("setValue",a);create_cols()}
function create_cols(){$("#tt").html("");for(var a="<tr><th  rowspan='2'>\u5a92\u4f53\u7c7b\u578b</td><th  rowspan='2'>\u5a92\u4f53</td><th  rowspan='2'>\u5e7f\u544a</td><th  rowspan='2'>\u603b\u4ef7</td>",b="<tr>",h=StringToDate($("#txtDateTime").datebox("getValue")+"-01"),g=h.FirstDayOfDate(),i=h.MaxDayOfDate(),j=1;j<=i;j++)g=StringToDate(g),a+="<th>"+j+"</th>",b+="<th>"+g.DatePart("w")+"</th>",g=g.DateAdd("d",1);a+="</tr>";b+="</tr>";$("#tt").html(a+b);a=h.Format("yyyy-MM-dd");$.ajax({url:"http://ggfx.syyx.cn/ad_schedule_search?r="+
Math.random(),type:"get",dataType:"json",data:{StatTime:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){$.each(a.rows,function(a,b){var c=b.ClassID,d=b.MediaID,e=b.ADID,f=b.SYear+"-"+b.SMonth+"-",g="<td>"+b.ClassName+"</td><td>"+b.MediaName+"</td><td>"+b.ADName+"</td><td>"+b.ADCost+"</td><td>"+getAdUrl(c,d,e,f+"1",b.Day1)+"</td><td>"+getAdUrl(c,d,e,f+"2",b.Day2)+"</td><td>"+getAdUrl(c,d,e,f+"3",b.Day3)+"</td><td>"+getAdUrl(c,d,e,f+"4",b.Day4)+
"</td><td>"+getAdUrl(c,d,e,f+"5",b.Day5)+"</td><td>"+getAdUrl(c,d,e,f+"6",b.Day6)+"</td><td>"+getAdUrl(c,d,e,f+"7",b.Day7)+"</td><td>"+getAdUrl(c,d,e,f+"8",b.Day8)+"</td><td>"+getAdUrl(c,d,e,f+"9",b.Day9)+"</td><td>"+getAdUrl(c,d,e,f+"10",b.Day10)+"</td><td>"+getAdUrl(c,d,e,f+"11",b.Day11)+"</td><td>"+getAdUrl(c,d,e,f+"12",b.Day12)+"</td><td>"+getAdUrl(c,d,e,f+"13",b.Day13)+"</td><td>"+getAdUrl(c,d,e,f+"14",b.Day14)+"</td><td>"+getAdUrl(c,d,e,f+"15",b.Day15)+"</td><td>"+getAdUrl(c,d,e,f+"16",b.Day16)+
"</td><td>"+getAdUrl(c,d,e,f+"17",b.Day17)+"</td><td>"+getAdUrl(c,d,e,f+"18",b.Day18)+"</td><td>"+getAdUrl(c,d,e,f+"19",b.Day19)+"</td><td>"+getAdUrl(c,d,e,f+"20",b.Day20)+"</td><td>"+getAdUrl(c,d,e,f+"21",b.Day21)+"</td><td>"+getAdUrl(c,d,e,f+"22",b.Day22)+"</td><td>"+getAdUrl(c,d,e,f+"23",b.Day23)+"</td><td>"+getAdUrl(c,d,e,f+"24",b.Day24)+"</td><td>"+getAdUrl(c,d,e,f+"25",b.Day25)+"</td><td>"+getAdUrl(c,d,e,f+"26",b.Day26)+"</td><td>"+getAdUrl(c,d,e,f+"27",b.Day27)+"</td>";27<i&&(g=g+"<td>"+getAdUrl(c,
d,e,f+"28",b.Day28)+"</td>");28<i&&(g=g+"<td>"+getAdUrl(c,d,e,f+"29",b.Day29)+"</td>");29<i&&(g=g+"<td>"+getAdUrl(c,d,e,f+"30",b.Day30)+"</td>");30<i&&(g=g+"<td>"+getAdUrl(c,d,e,f+"31",b.Day31)+"</td>");$("<tr class='newrow'></tr>").append(g).appendTo($("#tt tbody"))})}})};
