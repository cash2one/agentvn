function formatEnabled(a){return a?"<font color='blue'>\u542f\u7528</font>":"<font color='red'>\u7981\u7528</font>"}function formatSchedule(a){return a?"<font color='blue'>\u5df2\u8bbe\u7f6e</font>":"<font color='red'>\u8bbe\u7f6e\u4e2d</font>"}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}
function getAdUrl(a,b,c,d,e){return 1==e?"<a href='/ad_report_phase.html?ClassID="+a+"&MediaID="+b+"&ADID="+c+"&Date="+d+"'>\u221a</a>":" "}function checkAllByID(a){for(var b=document.getElementsByTagName("input"),c=b.length,d=0;d<c;d++)"checkbox"==b[d].type&&b[d].name==name&&(b[d].checked=a.checked)}function checkAllByName(a,b){var c=document.getElementsByName(b);if(void 0!=c)for(var d=0;d<c.length;d++)c[d].checked=a.checked}
Date.prototype.isLeapYear=function(){return 0==this.getYear()%4&&(0!=this.getYear()%100||0==this.getYear()%400)};
Date.prototype.Format=function(a){a=a.replace(/yyyy|YYYY/,this.getFullYear());a=a.replace(/yy|YY/,9<this.getYear()%100?(this.getYear()%100).toString():"0"+this.getYear()%100);a=a.replace(/MM/,9<this.getMonth()+1?(this.getMonth()+1).toString():"0"+(this.getMonth()+1));a=a.replace(/M/g,this.getMonth());a=a.replace(/w|W/g,"\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",")[this.getDay()]);a=a.replace(/dd|DD/,9<this.getDate()?this.getDate().toString():"0"+this.getDate());a=a.replace(/d|D/g,
this.getDate());a=a.replace(/hh|HH/,9<this.getHours()?this.getHours().toString():"0"+this.getHours());a=a.replace(/h|H/g,this.getHours());a=a.replace(/mm/,9<this.getMinutes()?this.getMinutes().toString():"0"+this.getMinutes());a=a.replace(/m/g,this.getMinutes());a=a.replace(/ss|SS/,9<this.getSeconds()?this.getSeconds().toString():"0"+this.getSeconds());return a=a.replace(/s|S/g,this.getSeconds())};
Date.prototype.DateAdd=function(a,b){switch(a){case "s":return new Date(Date.parse(this)+1E3*b);case "n":return new Date(Date.parse(this)+6E4*b);case "h":return new Date(Date.parse(this)+36E5*b);case "d":return new Date(Date.parse(this)+864E5*b);case "w":return new Date(Date.parse(this)+6048E5*b);case "q":return new Date(this.getFullYear(),this.getMonth()+3*b,this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds());case "m":return new Date(this.getFullYear(),this.getMonth()+b,this.getDate(),
this.getHours(),this.getMinutes(),this.getSeconds());case "y":return new Date(this.getFullYear()+b,this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds())}};
Date.prototype.DateDiff=function(a,b){"string"==typeof b&&(b=StringToDate(b));switch(a){case "s":return parseInt((b-this)/1E3);case "n":return parseInt((b-this)/6E4);case "h":return parseInt((b-this)/36E5);case "d":return parseInt((b-this)/864E5);case "w":return parseInt((b-this)/6048E5);case "m":return b.getMonth()+1+12*(b.getFullYear()-this.getFullYear())-(this.getMonth()+1);case "y":return b.getFullYear()-this.getFullYear()}};
Date.prototype.DatePart=function(a){var b="",c="\u65e5,\u4e00,\u4e8c,\u4e09,\u56db,\u4e94,\u516d".split(",");switch(a){case "y":b=this.getFullYear();break;case "m":b=this.getMonth()+1;break;case "d":b=this.getDate();break;case "w":b=c[this.getDay()];break;case "ww":b=this.WeekNumOfYear();break;case "h":b=this.getHours();break;case "n":b=this.getMinutes();break;case "s":b=this.getSeconds()}return b};Date.prototype.FirstDayOfDate=function(){var a=this.toArray();return new Date(a[0],a[1],1)};
Date.prototype.LastDayOfDate=function(){return this.FirstDayOfDate().DateAdd("m",1).DateAdd("d",-1)};Date.prototype.MaxDayOfDate=function(){return this.LastDayOfDate().DatePart("d")};Date.prototype.toArray=function(){var a=[];a[0]=this.getFullYear();a[1]=this.getMonth();a[2]=this.getDate();a[3]=this.getHours();a[4]=this.getMinutes();a[5]=this.getSeconds();return a};
function IsValidDate(a){var b=a.replace(/(^\s+|\s+$)/g,"");if(""==b)return!0;if(""==b.replace(/[\d]{ 4,4 }[\-/]{ 1 }[\d]{ 1,2 }[\-/]{ 1 }[\d]{ 1,2 }/g,"")){if(a=new Date(b.replace(/\-/g,"/")),b=b.split(/[-/:]/),b[0]!=a.getYear()||b[1]!=a.getMonth()+1||b[2]!=a.getDate())return!1}else return!1;return!0}
function CheckDateTime(a){a=a.match(/^(\d+)-(\d{ 1,2 })-(\d{ 1,2 }) (\d{ 1,2 }):(\d{ 1,2 }):(\d{ 1,2 })$/);if(null==a)return!1;a[2]-=1;var b=new Date(a[1],a[2],a[3],a[4],a[5],a[6]);return b.getFullYear()!=a[1]||b.getMonth()!=a[2]||b.getDate()!=a[3]||b.getHours()!=a[4]||b.getMinutes()!=a[5]||b.getSeconds()!=a[6]?!1:!0}function StringToDate(a){var b=Date.parse(a),b=new Date(b);isNaN(b)&&(a=a.split("-"),b=new Date(a[0],--a[1],a[2]));return b}
function set_date(a,b){var c=new Date,d=c.Format("yyyy-MM-dd"),c=c.DateAdd(a,b).Format("yyyy-MM-dd");$("#txtStartTime").datebox("setValue",c);$("#txtEndTime").datebox("setValue",d)}function get_game_list(a){$.ajax({url:"http://ggfx.syyx.cn/dict_game?r="+Math.random(),type:"get",dataType:"json",data:{IsAll:0},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(b){a(b.rows)}})}
function get_adclass_list(a){$.ajax({url:"http://ggfx.syyx.cn/ad_class_list?r="+Math.random(),type:"get",dataType:"json",data:{},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(b){a(b.rows)}})}
function get_admedia_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_media_list?r="+Math.random(),type:"get",dataType:"json",data:{ClassID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})}
function get_adad_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_ad_list?r="+Math.random(),type:"get",dataType:"json",data:{MediaID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})}
function get_adwebnumber_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_webnumber_list?r="+Math.random(),type:"get",dataType:"json",data:{ADID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})}var def_classid,def_mediaid,def_adid;
$(function(){def_classid=getParameterByName("ClassID");def_mediaid=getParameterByName("MediaID");def_adid=getParameterByName("ADID");def_date=getParameterByName("Date");set_date("d",0);""!=def_date&&($("#txtStartTime").datebox("setValue",def_date),$("#txtEndTime").datebox("setValue",def_date));init_game_list();init_ad_info();$("#ddlClass").change(function(){init_admedia_list(this.value)});$("#ddlMedia").change(function(){init_adad_list(this.value)});$("#ddlAd").change(function(){init_adwebnumber_list(this.value)})});
function init_ad_info(){init_adclass_list();init_admedia_list(def_classid);init_adad_list(def_mediaid);init_adwebnumber_list(def_adid)}function init_game_list(){$("#ddlGame").empty();get_game_list(function(a){$.each(a,function(a,c){$("#ddlGame").append("<option value='"+c.ID+"'>"+c.Title+"</option>")})})}
var init_adclass_list=function(){$("#ddlClass").empty();$("#ddlClass").append("<option value=0>\u6240\u6709</option");get_adclass_list(function(a){$.each(a,function(a,c){$("#ddlClass").append("<option value='"+c.ID+"'>"+c.ClassName+"</option>")});""!=def_classid&&$("#ddlClass").val(def_classid)})},init_admedia_list=function(a){$("#ddlMedia").empty();$("#ddlMedia").append("<option value=0>\u6240\u6709</option");""==a?init_adad_list(0):get_admedia_list(a,function(a){$.each(a,function(a,b){$("#ddlMedia").append("<option value='"+
b.ID+"'>"+b.MediaName+"</option>")});""!=def_mediaid&&$("#ddlMedia").val(def_mediaid)})},init_adad_list=function(a){$("#ddlAd").empty();$("#ddlAd").append("<option value=0>\u6240\u6709</option");""==a?init_adwebnumber_list(0):get_adad_list(a,function(a){$.each(a,function(a,b){$("#ddlAd").append("<option value='"+b.ID+"'>"+b.ADName+"</option>")});""!=def_adid&&$("#ddlAd").val(def_adid)})},init_adwebnumber_list=function(a){$("#ddlAdWebNumber").empty();$("#ddlAdWebNumber").append("<option value='0'>\u6240\u6709</option");
""!=a&&get_adwebnumber_list(a,function(a){$.each(a,function(a,b){$("#ddlAdWebNumber").append("<option value='"+b.ID+"'>"+b.ADWebNumber+"</option>")})})};$(function(){select_game_list();get_ad_info(0,0,0);$("#ddlSelectClass").change(function(){select_admedia_list(this.value,0)});$("#ddlSelectMedia").change(function(){select_adad_list(this.value,0)});$("#ddlSelectAd").change(function(){select_adwebnumber_list(this.value,0)})});
function get_ad_info(a,b,c){select_adclass_list(a);select_admedia_list(a,b);select_adad_list(b,c)}function select_game_list(){$("#ddlSelectGame").empty();get_game_list(function(a){$.each(a,function(a,c){$("#ddlSelectGame").append("<option value='"+c.ID+"'>"+c.Title+"</option>")})})}
var select_adclass_list=function(a){$("#ddlSelectClass").empty();$("#ddlSelectClass").append("<option value=0>\u8bf7\u9009\u62e9</option");get_adclass_list(function(b){$.each(b,function(a,b){$("#ddlSelectClass").append("<option value='"+b.ID+"'>"+b.ClassName+"</option>")});0!=a&&$("#ddlSelectClass").val(a)})},select_admedia_list=function(a,b){$("#ddlSelectMedia").empty();$("#ddlSelectMedia").append("<option value=0>\u8bf7\u9009\u62e9</option");0==a?select_adad_list(0,0):get_admedia_list(a,function(a){$.each(a,
function(a,b){$("#ddlSelectMedia").append("<option value='"+b.ID+"'>"+b.MediaName+"</option>")});0!=b&&$("#ddlSelectMedia").val(b)})},select_adad_list=function(a,b){$("#ddlSelectAd").empty();$("#ddlSelectAd").append("<option value=0>\u8bf7\u9009\u62e9</option");0!=a&&get_adad_list(a,function(a){$.each(a,function(a,b){$("#ddlSelectAd").append("<option value='"+b.ID+"'>"+b.ADName+"</option>")});0!=b&&$("#ddlSelectAd").val(b)})};var classid,mediaid,pageindex=1,pagesize=20;$(function(){$("#btnSearch").click(function(){get_list()});$("#btnOK").click(function(){0==$("#hidID").val()?add_record():update_record()});var a=(new Date).Format("yyyy-MM-dd");$("#txtDate1").datebox("setValue",a);$("#txtDate2").datebox("setValue",a)});function clear_form(){$("#hidID").val(0);$("#txtADName").val(" ");$("#txtADPlace").val(" ");$("#txtADRemark").val(" ");$("#txtADEndUrl").val(" ")}
function get_list(){clear_form();var a=$("#ddlGame").val(),b=$("#ddlMedia").val();$.ajax({url:"http://ggfx.syyx.cn/ad_ad_page?r="+Math.random(),type:"get",dataType:"json",data:{GameID:a,MediaID:b,PageIndex:pageindex,PageSize:pagesize},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){$("#tt tbody").find("tr.newrow").remove();$.each(a.rows,function(a,b){$("<tr class='newrow'></tr>").append("<td>"+b.ClassName+"</td><td>"+b.MediaName+"</td><td>"+
b.ADName+"</td><td>"+b.ADPlace+"</td><td><input id='adlink"+b.ID+"' type='hidden' value='http://stat.syyx.com/click.aspx?aid="+b.ID+"&gourl="+b.ADEndUrl+"'/><span id='copy_ad"+b.ID+"' onmouseover=\"ClickCopy("+b.ID+", '"+b.MediaName+"', '"+b.ADName+"')\"><u>\u70b9\u51fb\u590d\u5236</u></span></td><td><input id='adshow"+b.ID+"' type='hidden' value='http://stat.syyx.com/statshow.aspx?aid="+b.ID+"'/><span id='copy_show"+b.ID+"' onmouseover=\"ClickCopyShow("+b.ID+", '"+b.MediaName+"', '"+b.ADName+"', false)\"><u>\u70b9\u51fb\u590d\u5236</u></span>&nbsp<span id='copy_flash"+
b.ID+"' onmouseover=\"ClickCopyShow("+b.ID+", '"+b.MediaName+"', '"+b.ADName+"', true)\"><u>\u70b9\u51fb\u590d\u5236(\u89c6\u9891)</u></span></td><td>"+formatEnabled(b.IsDelete)+"</td><td>"+formatEnabled(b.IsShow)+"</td><td><a href='javascript:void(0)' onclick='get_record("+b.ID+")'>\u7f16\u8f91</a></td>").appendTo($("#tt tbody"))});$("#pp").pagination({total:a.total,pageSize:pagesize,showPageList:!1,showRefresh:!1,onSelectPage:function(a){pageindex=a;get_list()}})}})}
function get_record(a){$.ajax({url:"http://ggfx.syyx.cn/ad_ad_record?r="+Math.random(),type:"get",dataType:"json",data:{ID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){$.each(a.rows,function(a,b){$("#hidID").val(b.ID);$("#ddlSelectGame").val(b.GameID);get_ad_info(b.ClassID,b.MediaID,b.ID);$("#txtADName").val(b.ADName);var e=b.BeginTime.split(" ");$("#txtDate1").datebox("setValue",e[0]);$("#txtTime1").val(e[1]);e=b.EndTime.split(" ");
$("#txtDate2").datebox("setValue",e[0]);$("#txtTime2").val(e[1]);$("#txtADPlace").val(b.ADPlace);$("#txtADRemark").val(b.ADRemark);$("#txtADEndUrl").val(b.ADEndUrl);$("#chkIsDelete").attr("checked",b.IsDelete);$("#chkIsShow").attr("checked",b.IsShow)})}})}
function add_record(){var a=$("#ddlSelectGame").val(),b=$("#txtADName").val(),c=$("#txtDate1").datebox("getValue")+" "+$("#txtTime1").val(),d=$("#txtDate2").datebox("getValue")+" "+$("#txtTime2").val(),e=$("#txtADPlace").val(),g=$("#txtADRemark").val(),h=$("#txtADEndUrl").val(),i=$("#chkIsDelete").attr("checked"),j=$("#chkIsShow").attr("checked"),f=$("#ddlSelectMedia").val();0==f?alert("\u8bf7\u9009\u62e9\u6240\u5c5e\u5a92\u4f53"):""==b?alert("\u8bf7\u586b\u5199\u5a92\u4f53\u540d\u79f0"):$.ajax({url:"http://ggfx.syyx.cn/ad_ad_add?r="+
Math.random(),type:"get",dataType:"json",data:{ID:0,GameID:a,ADName:b,BeginTime:c,EndTime:d,ADPlace:e,ADRemark:g,ADEndUrl:h,IsDelete:i,IsShow:j,AddUserId:0,OrderBy:0,GroupID:f,TypeID:1},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?(alert("\u6210\u529f"),get_list()):alert("\u5931\u8d25")}})}
function update_record(){var a=$("#hidID").val(),b=$("#ddlSelectGame").val(),c=$("#txtADName").val(),d=$("#txtDate1").datebox("getValue")+" "+$("#txtTime1").val(),e=$("#txtDate2").datebox("getValue")+" "+$("#txtTime2").val(),g=$("#txtADPlace").val(),h=$("#txtADRemark").val(),i=$("#txtADEndUrl").val(),j=$("#chkIsDelete").attr("checked"),f=$("#chkIsShow").attr("checked"),k=$("#ddlSelectMedia").val();0==k?alert("\u8bf7\u9009\u62e9\u6240\u5c5e\u5a92\u4f53"):""==c?alert("\u8bf7\u586b\u5199\u5a92\u4f53\u540d\u79f0"):
$.ajax({url:"http://ggfx.syyx.cn/ad_ad_update?r="+Math.random(),type:"get",dataType:"json",data:{ID:a,GameID:b,ADName:c,BeginTime:d,EndTime:e,ADPlace:g,ADRemark:h,ADEndUrl:i,IsDelete:j,IsShow:f,AddUserId:0,OrderBy:0,GroupID:k,TypeID:1},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?(alert("\u6210\u529f"),get_list()):alert("\u5931\u8d25")}})}ZeroClipboard.setMoviePath("/javascripts/include/ZeroClipboard.swf");var clip=null;
function ClickCopy(a,b,c){clip=new ZeroClipboard.Client;clip.setHandCursor(!0);clip.addEventListener("mouseOver",function(b){var c=$("#adlink"+a).val();b.setText(c)});clip.addEventListener("complete",function(){alert("<"+b+"> -- <"+c+">\u7684\u3010\u5e7f\u544a\u94fe\u63a5\u3011\u5df2\u7ecf\u590d\u5236\u5230\u7c98\u8d34\u677f\uff01\n\r\n\r\u53ef\u4ee5\u4f7f\u7528 Ctrl+V \u8d34\u5230\u9700\u8981\u7684\u5730\u65b9\u53bb\u4e86\u54e6^_^")});clip.glue("copy_ad"+a)}
function ClickCopyShow(a,b,c,d){clip=new ZeroClipboard.Client;clip.setHandCursor(!0);clip.addEventListener("mouseOver",function(b){var c;c=d?'loadVariables("'+$("#adshow"+a).val()+'","","GET");':'<iframe src="'+$("#adshow"+a).val()+'" style="display:none"></iframe>';b.setText(c)});clip.addEventListener("complete",function(){alert("<"+b+"> -- <"+c+">\u7684\u3010\u5e7f\u544a\u94fe\u63a5\u3011\u5df2\u7ecf\u590d\u5236\u5230\u7c98\u8d34\u677f\uff01\n\r\n\r\u53ef\u4ee5\u4f7f\u7528 Ctrl+V \u8d34\u5230\u9700\u8981\u7684\u5730\u65b9\u53bb\u4e86\u54e6^_^")});
d?clip.glue("copy_flash"+a):clip.glue("copy_show"+a)};
