function formatEnabled(a){return a?"<font color='blue'>\u542f\u7528</font>":"<font color='red'>\u7981\u7528</font>"}function formatSchedule(a){return a?"<font color='blue'>\u5df2\u8bbe\u7f6e</font>":"<font color='red'>\u8bbe\u7f6e\u4e2d</font>"}function getParameterByName(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");a=RegExp("[\\?&]"+a+"=([^&#]*)").exec(window.location.search);return null==a?"":decodeURIComponent(a[1].replace(/\+/g," "))}
function getAdUrl(a,b,d,c,e){return 1==e?"<a href='/ad_report_phase.html?ClassID="+a+"&MediaID="+b+"&ADID="+d+"&Date="+c+"'>\u221a</a>":" "}function checkAllByID(a){for(var b=document.getElementsByTagName("input"),d=b.length,c=0;c<d;c++)"checkbox"==b[c].type&&b[c].name==name&&(b[c].checked=a.checked)}function checkAllByName(a,b){var d=document.getElementsByName(b);if(void 0!=d)for(var c=0;c<d.length;c++)d[c].checked=a.checked}
function get_game_list(a){$.ajax({url:"http://ggfx.syyx.cn/dict_game?r="+Math.random(),type:"get",dataType:"json",data:{IsAll:0},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(b){a(b.rows)}})}function get_adclass_list(a){$.ajax({url:"http://ggfx.syyx.cn/ad_class_list?r="+Math.random(),type:"get",dataType:"json",data:{},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(b){a(b.rows)}})}
function get_admedia_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_media_list?r="+Math.random(),type:"get",dataType:"json",data:{ClassID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})}
function get_adad_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_ad_list?r="+Math.random(),type:"get",dataType:"json",data:{MediaID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})}
function get_adwebnumber_list(a,b){$.ajax({url:"http://ggfx.syyx.cn/ad_webnumber_list?r="+Math.random(),type:"get",dataType:"json",data:{ADID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){b(a.rows)}})};var pageindex=1,pagesize=20;$(function(){var a=getParameterByName("ClassID");init_adclass_list(a);$("#btnSearch").click(function(){get_list()});$("#btnOK").click(function(){0==$("#hidID").val()?add_record():update_record()})});function clear_form(){$("#hidID").val(0);$("#txtMediaName").val(" ");$("#txtMediaRemark").val(" ")}
function get_list(){clear_form();var a=$("#ddlSearchClass").val(),b=$("#txtKeyword").val(),d=$("#ddlIsEnabled").val(),c=$("#ddlIsShow").val();$.ajax({url:"http://ggfx.syyx.cn/ad_media_page?r="+Math.random(),type:"get",dataType:"json",data:{ClassID:a,MediaName:b,IsEnabled:d,IsShow:c,PageIndex:pageindex,PageSize:pagesize},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(b){$("#tt tbody").find("tr.newrow").remove();$.each(b.rows,function(b,c){$("<tr class='newrow'></tr>").append("<td>"+
c.ClassName+"</td><td>"+c.MediaName+"</td><td>"+c.MediaRemark+"</td><td>"+c.Numbers+"</td><td>"+formatEnabled(c.IsEnabled)+"</td><td>"+formatEnabled(c.IsShow)+"</td><td><a href='ad_ad.html?ClassID="+a+"&MediaID="+c.ID+"'>\u6dfb\u52a0\u5e7f\u544a</a>&nbsp<a href='javascript:void("+c.ID+")' onclick='get_record("+c.ID+")'>\u7f16\u8f91</a></td>").appendTo($("#tt tbody"))});$("#pp").pagination({total:b.total,pageSize:pagesize,showPageList:!1,showRefresh:!1,onSelectPage:function(a){pageindex=a;get_list()}})}})}
function get_record(a){$.ajax({url:"http://ggfx.syyx.cn/ad_media_record?r="+Math.random(),type:"get",dataType:"json",data:{ID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0<a.rows.length&&(a=a.rows[0],$("#hidID").val(a.ID),$("#ddlClass").val(a.ClassID),$("#txtMediaName").val(a.MediaName),$("#txtMediaRemark").val(a.MediaRemark),$("#chkIsEnabled").attr("checked",a.IsEnabled),$("#chkIsShow").attr("checked",a.IsShow))}})}
function add_record(){var a=$("#ddlClass").val(),b=$("#txtMediaName").val(),d=$("#txtMediaRemark").val(),c=$("#chkIsEnabled").attr("checked"),e=$("#chkIsShow").attr("checked");0>=a?alert("\u8bf7\u9009\u62e9\u5a92\u4f53\u7c7b\u578b"):!b||""==b?alert("\u5a92\u4f53\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"):$.ajax({url:"http://ggfx.syyx.cn/ad_media_add?r="+Math.random(),type:"get",dataType:"json",data:{ClassID:a,MediaName:b,MediaRemark:d,IsEnabled:c,IsShow:e,AddUserId:1},beforeSend:function(){$("#loading").show()},
complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?(alert("\u6210\u529f"),get_list()):alert("\u5931\u8d25")}})}
function update_record(){var a=$("#hidID").val(),b=$("#ddlClass").val(),d=$("#txtMediaName").val(),c=$("#txtMediaRemark").val(),e=$("#chkIsEnabled").attr("checked"),f=$("#chkIsShow").attr("checked");0>=b?alert("\u8bf7\u9009\u62e9\u5a92\u4f53\u7c7b\u578b"):!d||""==d?alert("\u5a92\u4f53\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a"):$.ajax({url:"http://ggfx.syyx.cn/ad_media_update?r="+Math.random(),type:"get",dataType:"json",data:{ID:a,ClassID:b,MediaName:d,MediaRemark:c,IsEnabled:e,IsShow:f},beforeSend:function(){$("#loading").show()},
complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?(alert("\u6210\u529f"),get_list()):alert("\u5931\u8d25")}})}
function init_adclass_list(a){$("#ddlClass").empty();$("#ddlClass").append("<option value=-1>\u8bf7\u9009\u62e9</option");$("#ddlSearchClass").empty();$("#ddlSearchClass").append("<option value=0>\u6240\u6709</option");get_adclass_list(function(b){$.each(b,function(a,b){$("#ddlClass").append("<option value='"+b.ID+"'>"+b.ClassName+"</option>");$("#ddlSearchClass").append("<option value='"+b.ID+"'>"+b.ClassName+"</option>")});$("#ddlSearchClass").val(a);get_list()})};
