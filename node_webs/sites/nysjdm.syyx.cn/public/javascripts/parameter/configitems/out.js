function formatEnabled(a){return a?'<font color="blue">\u662f</font>':'<font color="red">\u5426</font>'}function formateDate(a){a=a.substring(a.indexOf(" ")).split(":");return{Hour:a[0],Minute:a[1]}}function getDate(a){var b=a.getFullYear(),c=a.getMonth()+1;10>c&&(c="0"+c);a=a.getDate();10>a&&(a="0"+a);return b+"-"+c+"-"+a};$(document).ready(function(){$("#hiddenID").val(0);getParamsList();$("#btnQuery").bind("click",function(){getItemList()});$("#btnAdd").toggle(function(){$("#btnAdd").val("\u53d6\u6d88");clear_form()},function(){$("#btnAdd").val("\u6dfb\u52a0");clear_form()});$("#btnSave").bind("click",function(){0==$("#hiddenID").val()?add_item():upd_item()});$("#configParams").change(function(a){var b=$(this).children("option:selected").val();getClassList(b);a.stopPropagation()})});
function getItemList(){clear_form();var a=$("#configClass").children("option:selected").val(),b=$("#configType").children("option:selected").val();!a||""==a?$.messager.alert("\u63d0\u793a","<font color=red><b>\u7edf\u8ba1\u7c7b\u4e0d\u80fd\u4e3a\u7a7a\uff0c\u8bf7\u5148\u8fdb\u884c\u76f8\u5e94\u914d\u7f6e</b></font>","error"):$("#listconfigItems").datagrid({url:"http://nysjdm.syyx.cn/parameter/config_items_list_post?ClassID="+a+"&GetType="+b+"&r="+Math.random(),title:"\u53c2\u6570\u914d\u7f6e",width:680,
height:300,fitColumns:!0,nowrap:!1,rownumbers:!0,singleSelect:!0,columns:[[{field:"ItemNo",title:"\u7f16\u53f7",width:100,align:"center"},{field:"ItemName",title:"\u540d\u79f0",width:250,align:"center"},{field:"OrderNo",title:"\u6392\u5e8f",width:80,align:"center"},{field:"IsEnabled",title:"\u662f\u5426\u542f\u7528",width:80,align:"center",formatter:function(a){return formatEnabled(a)}},{field:"op",title:"\u64cd\u4f5c",width:60,align:"center",formatter:function(a,b){return"<a href='#' onclick=get_record_info("+
b.ID+")>\u7f16\u8f91</a>  <a href='#' onclick=del_record_info("+b.ID+")>\u5220\u9664</a>"}}]]})}
function get_record_info(a){$("#hiddenID").val(a);$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_items_info?r="+Math.random(),type:"get",dataType:"json",data:{ItemID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0<a.rows.length&&(a=a.rows[0],$("#txtItemNo").val(a.ItemNo),$("#txtItemName").val(a.ItemName),$("#txtOrderNo").val(a.OrderNo),$("#chkEnable").attr("checked",a.IsEnabled))}})}
function del_record_info(a){$.messager.confirm("\u786e\u8ba4","\u786e\u5b9a\u8981\u5220\u9664\u8be5\u8bb0\u5f55\u5417\uff1f",function(b){b&&$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_items_del?r="+Math.random(),type:"get",dataType:"json",data:{ItemID:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0==a.err?($.messager.alert("\u63d0\u793a","\u5220\u9664\u8bb0\u5f55\u6210\u529f","info"),getItemList()):$.messager.alert("\u63d0\u793a",
"<font color=red><b>\u5220\u9664\u8bb0\u5f55\u5931\u8d25</b></font>","error")}})})}
function getParamsList(){$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_params_list?r="+Math.random(),type:"get",dataType:"json",data:{},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){$("#configParams").empty();$.each(a.rows,function(a,c){$('<option value="'+c.ParamsFlag+'"> '+c.ParamsName+"</option>").appendTo($("#configParams"))});getClassList($("#configParams").children("option:selected").val())}})}
function getClassList(a){$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_class_list?r="+Math.random(),type:"get",dataType:"json",data:{ParamsType:a},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){$("#configClass").empty();$.each(a.rows,function(a,b){$('<option value="'+b.ID+'"> '+b.ClassName+"</option>").appendTo($("#configClass"))})}})}
function clear_form(){$("#hiddenID").val(0);$("#txtItemNo").val("");$("#txtItemName").val("");$("#txtOrderNo").val("");$("#chkEnable").attr("checked",!1)}
function add_item(){var a=$("#txtItemNo").val(),b=$("#txtItemName").val(),c=$("#configClass").children("option:selected").val(),e=$("#configType").children("option:selected").val(),d=$("#txtOrderNo").val(),f="checked"==$("#chkEnable").attr("checked");if(!a||""==a)$.messager.alert("\u63d0\u793a","<font color=red><b>\u7f16\u53f7\u4e0d\u80fd\u4e3a\u7a7a</b></font>","error");else if(!b||""==b)$.messager.alert("\u63d0\u793a","<font color=red><b>\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a</b></font>","error");
else{if(!d||""==d)d=1;$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_items_add?r="+Math.random(),type:"get",dataType:"json",data:{ItemNo:a,ItemName:b,ClassID:c,GetType:e,OrderNo:d,IsEnabled:f},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?($.messager.alert("\u63d0\u793a","\u6dfb\u52a0\u8bb0\u5f55\u6210\u529f","info"),getItemList()):$.messager.alert("\u63d0\u793a","<font color=red><b>\u6dfb\u52a0\u8bb0\u5f55\u5931\u8d25</b></font>",
"error")}})}}
function upd_item(){var a=$("#hiddenID").val(),b=$("#txtItemNo").val(),c=$("#txtItemName").val(),e=$("#configClass").children("option:selected").val(),d=$("#configType").children("option:selected").val(),f=$("#txtOrderNo").val(),g="checked"==$("#chkEnable").attr("checked");!b||""==b?$.messager.alert("\u63d0\u793a","<font color=red><b>\u7f16\u53f7\u4e0d\u80fd\u4e3a\u7a7a</b></font>","error"):!c||""==c?$.messager.alert("\u63d0\u793a","<font color=red><b>\u540d\u79f0\u4e0d\u80fd\u4e3a\u7a7a</b></font>","error"):
$.ajax({url:"http://nysjdm.syyx.cn/parameter/config_items_upd?r="+Math.random(),type:"get",dataType:"json",data:{ID:a,ItemNo:b,ItemName:c,ClassID:e,GetType:d,OrderNo:f,IsEnabled:g},beforeSend:function(){$("#loading").show()},complete:function(){$("#loading").hide()},success:function(a){0==a.retcode?($.messager.alert("\u63d0\u793a","\u66f4\u65b0\u8bb0\u5f55\u6210\u529f","info"),getItemList()):$.messager.alert("\u63d0\u793a","<font color=red><b>\u66f4\u65b0\u8bb0\u5f55\u5931\u8d25</b></font>","error")}})}
;
