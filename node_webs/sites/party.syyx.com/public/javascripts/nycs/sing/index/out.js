function default_set(){$("#login_out").click(function(){$.get("/login_out?r="+Math.random(),function(){document.location.reload()})});$("#map2").click(function(){$.get("/check_user_login?r="+Math.random(),function(b){b.login?document.location="http://party.syyx.com/nycs/sing/uploadsing.html#tp":login()})});$("#topcy").click(function(){$.get("/check_user_login?r="+Math.random(),function(b){b.login?document.location="http://party.syyx.com/nycs/sing/uploadsing.html#tp":login()})});$(".div_close").click(login_close);
$.get("/check_user_login?r="+Math.random(),function(b){b.login&&($("#login_a").show(),$("#user_name").html(b.UserAccount))})}function vote(b){var a=document.documentElement.scrollTop||document.body.scrollTop;$("#iframe").attr("src","/nycs/sing/vote.html?id="+b);$("#popup_bg").css("display","block");$("#div_login").css("top",a+80);$("#div_login").css("display","block");$("html").scrollTop($("html").scrollTop()+1);$("body").scrollTop($("body").scrollTop()+1)}
function login_close(){$("#div_login").css("display","none");$("#popup_bg").css("display","none")}function login(){var b=document.documentElement.scrollTop||document.body.scrollTop;$("#iframe").attr("src","/nycs/sing/login.html?type=up");$("#popup_bg").css("display","block");$("#div_login").css("top",b+80);$("#div_login").css("display","block");$("html").scrollTop($("html").scrollTop()+1);$("body").scrollTop($("body").scrollTop()+1)};$(function(){$("#map1").addClass("map1hover");get_toplist();get_newlist({page:1});default_set()});
function set_roll_page(b,a){if(1==a||0==a)$("#dispaly_page_num").hide();else{$("#dispaly_page_num").show();$("#dispaly_page_num span").empty();$("#dispaly_page_num span").append('<a name="1" href="javascript:undefined">\u9996\u9875</a>&nbsp;');1==b?$("#dispaly_page_num span").append('<a href="javascript:undefined" class="noclick">\u4e0a\u4e00\u9875</a>'):$("#dispaly_page_num span").append('<a class="prev" href="javascript:undefined">\u4e0a\u4e00\u9875</a>');var c=[];if(4<b)for(var d=b-3;d<b-3+7&&
!(c.push(d),d>=a);d++);else for(d=1;7>=d&&!(c.push(d),d>=a);d++);c.sort(compare);$.each(c,function(a,c){c==b?$("#dispaly_page_num span").append('<a name="'+c+'" class="current" href="javascript:undefined">'+c+"</a>"):$("#dispaly_page_num span").append('<a href="javascript:undefined" name="'+c+'">'+c+"</a>")});b==a?$("#dispaly_page_num span").append('<a href="javascript:undefined" class="noclick">\u4e0b\u4e00\u9875</a>'):$("#dispaly_page_num span").append('<a href="javascript:undefined" class="next">\u4e0b\u4e00\u9875</a>');
$("#dispaly_page_num span").append('&nbsp;<a href="javascript:undefined" class="last">\u672b\u9875</a>');$("#dispaly_page_num a.last").attr("name",a);0<b-1&&$("#dispaly_page_num a.prev").attr("name",b-1);b+1<=a&&$("#dispaly_page_num a.next").attr("name",b+1);$("#dispaly_page_num select").empty();for(d=1;d<=a;d++)d==b?$("#dispaly_page_num select").append('<option value="'+d+'" selected>'+d+"</option>"):$("#dispaly_page_num select").append('<option value="'+d+'">'+d+"</option>");$("#dispaly_page_num a").click(function(a){a.preventDefault();
(a=$(this).attr("name"))&&get_newlist({page:parseInt(a)})});$("#dispaly_page_num select").change(function(a){a.preventDefault();(a=this.options[this.selectedIndex].value)&&get_newlist({page:parseInt(a)})})}}function compare(b,a){return b<a?-1:b>a?1:0}function get_toplist(){var b={r:Math.random()};$.ajax({url:"/nycs/sing/get_toplist",data:b,dataType:"json",type:"GET",success:function(a){0<a.length&&toplist(a)}})}
function get_newlist(b){var a={Page:b.page,PageSize:5,r:Math.random()};$.ajax({url:"/nycs/sing/get_newlist",data:a,dataType:"json",type:"GET",success:function(a){0!=a.count&&0<a.rows.length&&newlist(a.rows);var d=0,d=0==a.count%5?parseInt(a.count/5):parseInt(a.count/5)+1;set_roll_page(b.page,d,"")}})}
function toplist(b){var a="",c;for(c in b)a+='<div class="slist"><span class="nickname">',a+=b[c].NickName,a+='</span><span class="votecount">'+b[c].votecount+"\u7968",a+='</span><span class="listlink"><a href="javascript:vote('+b[c].ID+')" class="a1"></a>',a+='<a href="/nycs/sing/singshow.html?id='+b[c].ID+'#tp" class="a2"></a></span>',a+='<div class="scontent">'+b[c].content+"</div>",a+="</div>";$(".toplist").html(a)}
function newlist(b){var a="",c;for(c in b)a+='<div class="slist"><span class="nickname">',a+=b[c].NickName,a+='</span><span class="votecount2">'+b[c].votecount+"\u7968",a+='</span><span class="listlink"><a href="javascript:vote('+b[c].ID+')" class="a1"></a>',a+='<a href="/nycs/sing/singshow.html?id='+b[c].ID+'#tp" class="a2"></a></span>',a+='<div class="scontent">'+b[c].content+"</div>",a+="</div>";$(".newlist").html(a)};
