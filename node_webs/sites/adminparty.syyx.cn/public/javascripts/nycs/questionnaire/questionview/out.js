var abcd="A\u3001,B\u3001,C\u3001,D\u3001,E\u3001,F\u3001,G\u3001,H\u3001,I\u3001,J\u3001,K\u3001,L\u3001,M\u3001,N\u3001,O\u3001,P\u3001,Q\u3001,R\u3001,S\u3001,T\u3001,U\u3001,V\u3001,W\u3001,X\u3001,Y\u3001,Z\u3001".split(","),num=0,questions=[],qustion_out={radio:function(a){var c=a.options,b=a.other,e=c.length,f='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',f=f+('<div id="q'+(num-1)+'">');a.config.random&&
(c=random_orde(c));for(var d=0;d<e;d++)f+='<p><label><input class="radio" type="radio" name="r'+a.id+'" mark="'+(void 0!==c[d].mark?c[d].mark+1:d+1)+'" next="'+(c[d].next||0)+'" />'+abcd[d]+c[d].item+"</label></p>";b&&(f+="<p>"+b.item+"\uff1a"+(20>=b.limit[1]?'<label><input class="in_text" maxlength="'+b.limit[1]+'" type="text" id="other'+(num-1)+'" name="r'+a.id+'" next="'+(b.next||0)+'" /></label> <span class="other_12">\u6700\u591a'+b.limit[1]+'\u5b57\uff0c\u8f93\u5165\u4e86<strong id="other_size'+
(num-1)+'">0</strong>\u4e2a\u5b57</span>':'<span class="other_12">(\u4e0d\u8d85\u8fc7'+b.limit[1]+'\u5b57\uff0c\u8f93\u5165\u4e86<strong id="other_size'+(num-1)+'">0</strong>\u4e2a\u5b57)</span><br /><textarea class="in_area" id="other'+(num-1)+'" name="r'+a.id+'" next="'+(b.next||0)+'"></textarea>')+"</p>");$("#question").append(f+"</div>");if(b){var g=num-1;$("#other"+g).click(function(){$("#other_size"+g).html($(this).val().length)});$("#other"+g).focus(function(){$("#q"+g+" .radio").attr("checked",
!1);$(this).css("color","").attr("dis","false")});$("#q"+g+" .radio").click(function(){$("#other"+g).css("color","#ccc").attr("dis","true")})}},choose:function(a){var c=a.options,b=c.length,e=a.config,e='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+("\uff08\u6700\u5c11\u9009"+(!e.min?1:e.min)+"\u9879\uff0c\u6700\u591a\u9009"+(e.max>b||-1==e.max||!e.max?b:e.max)+"\u9879\uff09")+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',e=e+('<div id="q'+(num-1)+'">');a.config.random&&
(c=random_orde(c));for(var f=0;f<b;f++)e+='<p><label><input type="checkbox" name="c'+a.id+'" mark="'+(void 0!==c[f].mark?c[f].mark+1:f+1)+'" />'+abcd[f]+c[f].item+"</label></p>";$("#question").append(e+"</div>")},blanks:function(a){for(var c=a.options,b=c.length,a='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',a=a+('<table border="0" id="q'+(num-1)+'">'),e=0;e<b;e++)a+='<tr><td class="td_right">'+c[e].item+"\uff1a</td>",
a+='<td><input class="in_text" type="text" id="b'+e+'" maxlength="'+c[e].limit[1]+'" minlenth="'+c[e].limit[0]+'" st_type = "'+c[e].type+'" /></td></tr>';$("#question").append(a+"</table>")},scoring:function(a){var c=a.options,b=c.length,e=a.config,f=e.range,d='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',d=d+('<table border="0" id="q'+(num-1)+'">'),d=d+('<tr><td></td><td><div class="score_left">'+f.left+'</div><div class="score_center">'+
f.mid+'</div><div class="score_right">'+f.right+"</div></td><td></td></tr>");a.config.random&&(c=random_orde(c));for(a=0;a<b;a++)f=void 0!==c[a].mark?c[a].mark:a,d+='<tr><td class="td_right">'+c[a].item+"</td>",d+='<td><div class="score_box"><div class="score_bg"></div><div class="score_bar"><span>'+e.score[0]+"</span><span>"+e.score[1]+"</span><span>"+e.score[2]+"</span><span>"+e.score[3]+"</span><span>"+e.score[4]+"</span></div></td>",d+='<td>\u5f97\u5206\uff1a<span class="score_num" mark="'+f+
'">0</span> \u5206</td></tr>';$("#question").append(d+"</table>");$(".score_bar span").mouseover(function(){$(this).parent().prev().css("width",50*($(this).index()+1))});$(".score_bar").mouseout(function(a){var b=$(this).prev().data("width")||0;$(this).prev().css("width",b);a.stopPropagation()});$(".score_bar span").click(function(){$(this).parents("td").next().find(".score_num").html($(this).html());$(this).parents(".score_bar").attr("title","\u91cd\u65b0\u6253\u5206");var a=$(this).parent().prev();
a.data("width",a.css("width"))})},matrix_radio:function(a){var c=a.rows,b=a.columns,e=b.length,f=c.length;a.config.random&&(b=random_orde(b));for(var a='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',a=a+('<table border="0" id="q'+(num-1)+'">'),d=-1;d<e;d++){for(var a=a+"<tr>",g=-1;g<f;g++)if(-1===d)a=-1===g?a+"<td>&nbsp;</td>":a+("<th>"+c[g].item+"</th>");else if(-1===g)a+='<td class="td_right">'+b[d].item+"</td>";
else var h=void 0!==b[d].mark?b[d].mark+1:d+1,a=a+('<td><input type="radio" name="r'+h+'" r="'+h+'" c="'+(g+1)+'" /></td>');a+="</tr>"}$("#question").append(a)},matrix_choose:function(a){var c=a.rows,b=a.columns,e=b.length,f=c.length;a.config.random&&(b=random_orde(b));for(var d=a.config,a='<div class="title">'+num+"\u3001"+a.type+"\uff1a"+a.title+("\uff08\u6bcf\u4e00\u884c\u90fd\u9700\u6700\u5c11\u9009"+(!d.min?1:d.min)+"\u9879\uff0c\u6700\u591a\u9009"+(d.max>e||-1==d.max||!d.max?e:d.max)+"\u9879\uff09")+
'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',a=a+('<table border="0" id="q'+(num-1)+'">'),d=-1;d<e;d++){for(var a=a+"<tr>",g=-1;g<f;g++)if(-1===d)a=-1===g?a+"<td>&nbsp;</td>":a+("<th>"+c[g].item+"</th>");else if(-1===g)a+='<td class="td_right">'+b[d].item+"</td>";else var h=void 0!==b[d].mark?b[d].mark+1:d+1,a=a+('<td><input type="checkbox" name="r'+h+'" r="'+h+'" c="'+(g+1)+'" /></td>');a+="</tr>"}$("#question").append(a)},QandA:function(a){var c=a.config,a='<div class="title">'+
num+"\u3001"+a.type+"\uff1a"+a.title+("\uff08\u6700\u5c11"+c.min+"\u5b57\uff0c\u6700\u591a"+c.max+"\u5b57\uff09")+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',a=a+('<div class="font_len">\u60a8\u8f93\u5165\u4e86\uff1a<span id="size'+(num-1)+'">0</span>\u4e2a\u5b57</div>'),a=a+('<textarea id="q'+(num-1)+'"></textarea>');$("#question").append(a);$("#q"+(num-1)).keyup(function(){$("#size"+(num-1)).html($(this).val().length)})},info:function(a){var c='<div class="title">'+
num+"\u3001"+a.type+"\uff1a"+a.title+'<span onclick="check('+(num-1)+')">\u9a8c\u8bc1\u6b64\u9898</span></div>',c=c+('<p id="q'+(num-1)+'">'+a.text+"</p>");$("#question").append(c)}};function random_orde(a){for(var c={},b=[],e=[],f=a.length,d=0;d<f;d++){var g=Math.random();b.push(g);c[g]=a[d];c[g].mark=d}b.sort();for(a=0;a<f;a++)e.push(c[b[a]]);return e}
var qustion_verify={radio:function(a,c){var b=a.options.length,e=a.other,f="";if($("#other"+c).length&&""!==$("#other"+c).val()&&"true"!==$("#other"+c).attr("dis")){b=$("#other"+c).val();if(!1==blanks_verify[e.type](b,e.item,e.limit))return!1;var f="input\uff1a"+b,d=$("#other"+c).attr("next");"0"!==d&&(num+=d-1)}else for(e=0;e<b;e++)d=$("#q"+c+" input").eq(e),"checked"==d.attr("checked")&&(f=d.attr("mark"),d=d.attr("next"),"0"!==d&&(num+=d-2));if(""==f||"input:"==f)return alert("\u8bf7\u9009\u62e9\u60a8\u7684\u7b54\u6848"),
!1;/input\uff1a/.test(f)?alert("\u7b54\u6848\u662f\uff1a"+f):alert("\u7b54\u6848\u662f\uff1a"+a.options[f-1].item)},choose:function(a,c){for(var b=a.options,e=b.length,f=a.config,d=f.max>e||-1==f.max||!f.max?e:f.max,f=!f.min?1:f.min,g=[],h=0;h<e;h++){var i=$("#q"+c+" input").eq(h);"checked"==i.attr("checked")&&g.push(b[i.attr("mark")-1].item)}if(d<g.length||f>g.length)return alert("\u8bf7\u6309\u7167\u8981\u6c42\u9009\u62e9\u60a8\u7684\u7b54\u6848\uff01"),!1;alert("\u7b54\u6848\u662f\uff1a"+g)},blanks:function(a,
c){for(var b=a.options,e=b.length,f=[],d=0;d<e;d++){var g=$("#q"+c+" input").eq(d).val();if(!1==blanks_verify[b[d].type](g,b[d].item,b[d].limit))return!1;f.push("\n"+b[d].item+"\uff1a"+g)}alert("\u7b54\u6848\u662f\uff1a"+f)},scoring:function(a,c){for(var b=[],e=a.options,f=e.length,d=0;d<f;d++){var g=$("#q"+c+" .score_num").eq(d),h=g.html(),g=Number(g.attr("mark"));if("0"==h)return alert("\u8bf7\u4e3a"+e[g].item+"\u6253\u5206\uff0c\u4e0d\u80fd\u62530\u5206\uff01"),!1;b[g]="\n"+e[g].item+"\uff1a"+
h}alert("\u7b54\u6848\u662f\uff1a"+b)},matrix_radio:function(a,c){for(var b=[],e=a.columns.length,f=a.rows.length*e,d=0;d<f;d++){var g=$("#q"+c+" input").eq(d);"checked"==g.attr("checked")&&(b[g.attr("r")-1]="\n"+a.columns[g.attr("r")-1].item+"\uff1a"+a.rows[g.attr("c")-1].item)}for(f=0;f<e;f++)if(!b[f])return alert("\u8bf7\u4e3a"+a.columns[f].item+"\u9009\u62e9\u4e00\u4e2a\u7b54\u6848\uff01"),!1;alert("\u7b54\u6848\u662f\uff1a"+b)},matrix_choose:function(a,c){for(var b=[],e=[],f=a.columns.length,
d=a.rows.length*f,g=0;g<d;g++){var h=$("#q"+c+" input").eq(g);if("checked"==h.attr("checked")){var i=h.attr("r");b[i-1]?(b[i-1]+="\uff0c"+a.rows[h.attr("c")-1].item,e[i-1].push(1)):(b[i-1]="\n"+a.columns[i-1].item+"\uff1a"+a.rows[h.attr("c")-1].item,e[i-1]=[1])}}g=a.config;d=g.max>f||-1==g.max||!g.max?f:g.max;g=!g.min?1:g.min;for(h=0;h<f;h++)if(!e[h]||e[h].length>d||e[h].length<g)return alert("\u8bf7\u4e3a"+a.columns[h].item+"\u9009\u62e9"+g+"-"+d+"\u4e2a\u7b54\u6848\uff01"),!1;alert("\u7b54\u6848\u662f\uff1a"+
b)},QandA:function(a,c){var b=a.config,e=$("#q"+c).val();if(e.length>b.max||e.length<b.min)return alert("\u60a8\u53ea\u80fd\u8f93\u5165"+b.min+"-"+b.max+"\u4e2a\u5b57"),!1;alert("\u7b54\u6848\u662f\uff1a"+e)},info:function(){alert("\u6b64\u9898\u6ca1\u6709\u7b54\u6848")}},blanks_verify={zh:function(a,c,b){if(!RegExp("^[\u4e00-\u9fa5]{"+b[0]+","+b[1]+"}$","g").test(a))return alert(c+"\u987b"+b[0]+"-"+b[1]+"\u4e2a\u6c49\u5b57"),!1},word:function(a,c,b){if(!RegExp("^[a-zA-Z_0-9]{"+b[0]+","+b[1]+"}$",
"g").test(a))return alert(c+"\u987b"+b[0]+"-"+b[1]+"\u4e2a\u6570\u5b57\u3001\u5b57\u6bcd\u6216\u8005\u4e0b\u5212\u7ebf"),!1},number:function(a,c,b){if(!RegExp("^\\d{"+b[0]+","+b[1]+"}$","g").test(a))return alert(c+"\u987b"+b[0]+"-"+b[1]+"\u4e2a\u6570\u5b57"),!1},email:function(a){if(!/^[a-zA-Z0-9_+.-]+\@(([a-zA-Z0-9-]+\.)+)?([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,4}$/.test(a))return alert("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u90ae\u7bb1\u5730\u5740\uff01"),!1},text:function(a,c,b){if(/^\s+$/g.test(a))return alert("\u8bf7\u4e0d\u8981\u5168\u90e8\u8f93\u5165\u7a7a\u683c"),
!1;if(a.length<b[0]||a.length>b[1])return alert(c+"\u53ea\u80fd\u586b\u5199"+b[0]+"-"+b[1]+"\u4e2a\u5b57\u7b26"),!1}};
function check(a){var c=questions[a];switch(c.type){case "\u5355\u9009":qustion_verify.radio(c,a);break;case "\u591a\u9009":qustion_verify.choose(c,a);break;case "\u586b\u7a7a":qustion_verify.blanks(c,a);break;case "\u6253\u5206":qustion_verify.scoring(c,a);break;case "\u77e9\u9635\u5355\u9009":qustion_verify.matrix_radio(c,a);break;case "\u77e9\u9635\u591a\u9009":qustion_verify.matrix_choose(c,a);break;case "\u95ee\u7b54":qustion_verify.QandA(c,a);break;case "\u8bf4\u660e":qustion_verify.info(c,
a);break;default:alert("\u7cfb\u7edf\u9519\u8bef")}}
function outtype(){num++;var a=questions[num-1];switch(a.type){case "\u5355\u9009":qustion_out.radio(a);break;case "\u591a\u9009":qustion_out.choose(a);break;case "\u586b\u7a7a":qustion_out.blanks(a);break;case "\u6253\u5206":qustion_out.scoring(a);break;case "\u77e9\u9635\u5355\u9009":qustion_out.matrix_radio(a);break;case "\u77e9\u9635\u591a\u9009":qustion_out.matrix_choose(a);break;case "\u95ee\u7b54":qustion_out.QandA(a);break;case "\u8bf4\u660e":qustion_out.info(a);break;default:alert("\u7cfb\u7edf\u9519\u8bef")}num!=
questions.length&&outtype()}var id=document.location.search;
$.get("/nycs/questionnaire/get_question"+id+"&json=1&r="+Math.random(),function(a){a=a.data;$("h1").html(a.name);$("#start").html(a.config.starttime);$("#end").html(a.config.endtime);$("#login").html(!0==a.config.login?"\u662f":"\u5426");$("#award").attr("src",a.award);$("#welcome").html(a.welcome.replace(/\{|\uff5b/g,"<span>").replace(/\}|\uff5d/g,"</span>"));$("#thanks").html(a.thanks.replace(/\{|\uff5b/g,"<span>").replace(/\}|\uff5d/g,"</span>"));questions=a.question;outtype()});
$.post("/login/check",function(a){0==a.ok&&(document.location="/login.html")},"json");
